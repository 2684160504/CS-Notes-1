# 板子清理

* 白绿黑连接串口，secureCRT COM3 连接，
baudrate改成 115200 否则会乱码

* 连接服务器，nfs 挂载服务器设置好的根目录，因为剩余空间不足，系统自我保护无法进入。
setenv bootargs 'mem=512M console=ttyAMA0,115200 ubi.mtd=2 mtdparts=hinand:1M(boot),4M(kernel),250M(rootfs) init=/linuxrc ip=192.168.1.182:192.168.1.223:192.168.1.1:255.255.255.0::eth0:off eth=18:0e:99:02:b1:87 root=/dev/nfs nfsroot=192.168.1.223:/var/rootfs,tcp,v3,nolock rw'

* nand read 0x42000000 0x100000 0x400000;bootm 0x42000000

* mount -t ubifs /dev/ubi0_0 /mnt/

* 板子文件在mnt目录下

* `df` 查看内存使用情况

* `du -h` 查看文件大小

* `du -h | sort` 进行排序


## 清理原因是库文件太大，需要使用 `strip` 重新编译

`strip` 经常用来去除目标文件中的一些符号表、调试符号表信息，以减小程序的大小。
* `eg.` : `arm-hisiv500-linux-strip libjson.a`

原理：`strip` 命令减少 `XCOFF（Common Object File Format）` 对象文件的大小。`strip` 命令从 `XCOFF` 对象文件中有选择地除去行号信息、重定位信息、调试段、`typchk` 段、注释段、文件头以及所有或部分符号表。

注意事项：

在实际的开发中， 经常需要对动态库 `.so` 进行 `strip` 操作， 减少占地空间。 而在调试的时候（比如用 `addr2line` ）， 就需要符号了。 因此， 通常的做法是： `strip` 前的库用来调试， `strip` 后的库用来实际发布， 他们两者有对应关系。 一旦发布的 `strip` 后的库出了问题， 就可以找对应的未 `strip` 的库来定位。

目标文件分为：可重定位文件、可执行文件、共享文件

| 参数 | 作用 |
| ---------- | ----------- |
| -e | 在对象文件的可选头中设置 F_LOADONLY 标志。如果对象文件放置在归档中，则该标志告知绑定程序（ld 命令），在与此归档链接时应忽略该对象文件中的符号。 |
| -E   | 复位（关闭）对象文件的可选头中的 F_LOADONLY 位。（请参阅 -e 标志。）   |
| -H   | 除去对象文件头、任何可选的头以及所有段的头部分。注：不除去符号表信息。   |
| -l   | （小写 L）从对象文件中除去行号信息。   |

strip的默认选项会去除.symbol节的内容以及.debug节的内容，因此尽量只对可执行文件执行strip而不要对静态库或动态库等目标文件strip。


附使用的参数：

| 参数 | 作用 |
| ---------- | ----------- |
| -r | 除了外部符号和静态符号条目，将全部符号表信息除去。不除去重定位信息。同时除去调试段和 typchk 段。这个选项产生一个对象文件，该对象文件仍可以用作输入到链接编辑器（ld 命令）中。 |
| -t | 除去大多数符号表信息，但并不除去函数符号或行号信息。 |
| -V | 打印 strip 命令的版本号。 |
| -x | 除去符号表信息，但并不除去静态或外部符号信息。-x 标志同时除去重定位信息，因此将不可能链接到该文件。 |
| -X mode | 指定应检查 strip 的对象文件的类型。mode 必须是下列之一：32 只处理 32 位对象文件；64 只处理 64 位对象文件；32_64 既处理 32 位对象文件，又处理 64 位对象文件；缺省值是处理 32 位对象文件（忽略 64 位对象文件）。也可以用 OBJECT_MODE 环境变量来设置 mode。例如，OBJECT_MODE=64 使 strip 处理任何 64 位对象文件，并忽略 32 位对象文件。-X 标志重设 OBJECT_MODE 变量。 |
| -- | （双连字符）将跟随在该标志后的所有参数解释为文件名。这就允许除去名称是以连字符开始的文件。 |
